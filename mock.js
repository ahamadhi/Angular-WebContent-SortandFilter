function isNumber(n) {
    return !isNaN(parseFloat(n)) && isFinite(n);
}

var app = angular.module('DemoMock', ['ngTable', 'ngMockE2E'])
.run(function($httpBackend, $filter, $log, ngTableParams) {
    // emulation of api server
    $httpBackend.whenGET(/data.*/).respond(function(method, url, data, headers) {
        var query = url.split('?')[1],
            requestParams = {};

        $log.log('Ajax request: ', url);

        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');
            requestParams[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
        }
        // parse url params
        for (var key in requestParams) {
            if (key.indexOf('[') >= 0) {
                var params = key.split(/\[(.*)\]/), value = requestParams[key], lastKey = '';

                angular.forEach(params.reverse(), function(name) {
                    if (name != '') {
                        var v = value;
                        value = {};
                        value[lastKey = name] = isNumber(v) ? parseFloat(v) : v;
                    }
                });
                requestParams[lastKey] = angular.extend(requestParams[lastKey] || {}, value[lastKey]);
            } else {
                requestParams[key] = isNumber(requestParams[key]) ? parseFloat(requestParams[key]) : requestParams[key];
            }
        }

        data = [
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "1",
            "DoBIH Number": "1",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=277324&y=730857&z=3&sv=277324,730857&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN7732430857",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=1",
            "Name": "Ben Chonzie",
            "SMC Section": "1",
            "RHB Section": "01A",
            "_Section": "1.1",
            "Height (m)": "931",
            "Height (ft)": "3054",
            "Map 1:50": "51 52",
            "Map 1:25": "OL47W 368W 379W",
            "Grid Ref": "NN773308",
            "GridRefXY": "NN7732430857",
            "xcoord": "277324",
            "ycoord": "730857",
            "Post 1997": "MUN"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "2",
            "DoBIH Number": "17",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=262911&y=718916&z=3&sv=262911,718916&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN6291118916",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=17",
            "Name": "Ben Vorlich",
            "SMC Section": "1",
            "RHB Section": "01B",
            "_Section": "1.2",
            "Height (m)": "985",
            "Height (ft)": "3232",
            "Map 1:50": "57",
            "Map 1:25": "OL46N OL47W 365N 368W",
            "Grid Ref": "NN629189",
            "GridRefXY": "NN6291118916",
            "xcoord": "262911",
            "ycoord": "718916",
            "Post 1997": "MUN"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "3",
            "DoBIH Number": "18",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=261746&y=717465&z=3&sv=261746,717465&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN6174617465",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=18",
            "Name": "Stuc a' Chroin",
            "SMC Section": "1",
            "RHB Section": "01B",
            "_Section": "1.2",
            "Height (m)": "975",
            "Height (ft)": "3199",
            "Map 1:50": "57",
            "Map 1:25": "OL46N OL47W 365N 368W",
            "Grid Ref": "NN617174",
            "GridRefXY": "NN6174617465",
            "xcoord": "261746",
            "ycoord": "717465",
            "Post 1997": "MUN"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "4",
            "DoBIH Number": "32",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=236707&y=702863&z=3&sv=236707,702863&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN3670702863",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=32",
            "Name": "Ben Lomond",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "974",
            "Height (ft)": "3196",
            "Map 1:50": "56",
            "Map 1:25": "OL39S 364S",
            "Grid Ref": "NN367028",
            "GridRefXY": "NN3670702863",
            "xcoord": "236707",
            "ycoord": "702863",
            "Post 1997": "MUN"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "5",
            "DoBIH Number": "26",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=243276&y=724417&z=3&sv=243276,724417&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4327624417",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=26",
            "Name": "Ben More",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "1174",
            "Height (ft)": "3852",
            "Map 1:50": "51",
            "Map 1:25": "OL46N 365N",
            "Grid Ref": "NN432244",
            "GridRefXY": "NN4327624417",
            "xcoord": "243276",
            "ycoord": "724417",
            "Post 1997": "MUN"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "6",
            "DoBIH Number": "27",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=243481&y=722712&z=3&sv=243481,722712&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4348122712",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=27",
            "Name": "Stob Binnein",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "1165",
            "Height (ft)": "3822",
            "Map 1:50": "51",
            "Map 1:25": "OL46N 365N",
            "Grid Ref": "NN434227",
            "GridRefXY": "NN4348122712",
            "xcoord": "243481",
            "ycoord": "722712",
            "Post 1997": "MUN"
        },
        {
            "1891": "TOP",
            "1921": "TOP",
            "1933": "TOP",
            "1953": "TOP",
            "1969": "TOP",
            "1974": "TOP",
            "1981": "TOP",
            "1984": "TOP",
            "1990": "TOP",
            "1997": "TOP",
            "Running No": "7",
            "DoBIH Number": "28",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=243842&y=722052&z=3&sv=243842,722052&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4384222052",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=28",
            "Name": "Stob Binnein - Stob Coire an Lochain",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "1068",
            "Height (ft)": "3504",
            "Map 1:50": "51",
            "Map 1:25": "OL46N 365N",
            "Grid Ref": "NN438220",
            "GridRefXY": "NN4384222052",
            "xcoord": "243842",
            "ycoord": "722052",
            "Post 1997": "TOP"
        },
        {
            "1891": "TOP",
            "Running No": "8",
            "DoBIH Number": "39",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=244847&y=722468&z=3&sv=244847,722468&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4484722468",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=39",
            "Name": "Stob Binnein - Creag a' Bhragit",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "923",
            "Height (ft)": "3028",
            "Map 1:50": "51",
            "Map 1:25": "OL46N 365N",
            "Grid Ref": "NN448224",
            "GridRefXY": "NN4484722468",
            "xcoord": "244847",
            "ycoord": "722468"
        },
        {
            "1891": "TOP",
            "1921": "TOP",
            "1933": "TOP",
            "1953": "TOP",
            "1969": "TOP",
            "1974": "TOP",
            "1981": "TOP",
            "1984": "TOP",
            "1990": "TOP",
            "1997": "TOP",
            "Running No": "9",
            "DoBIH Number": "33",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=245051&y=722592&z=3&sv=245051,722592&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4505122592",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=33",
            "Name": "Stob Binnein - Meall na Dige",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "966",
            "Height (ft)": "3169",
            "Map 1:50": "51",
            "Map 1:25": "OL46N 365N",
            "Grid Ref": "NN450225",
            "GridRefXY": "NN4505122592",
            "xcoord": "245051",
            "ycoord": "722592",
            "Post 1997": "TOP"
        },
        {
            "1891": "TOP",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "Running No": "10",
            "DoBIH Number": "29",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=240815&y=721112&z=3&sv=240815,721112&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4081521112",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=29",
            "Name": "Cruach Ardrain SW Top",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "1044.9",
            "Height (ft)": "3428",
            "Map 1:50": "51 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN408211",
            "GridRefXY": "NN4081521112",
            "xcoord": "240815",
            "ycoord": "721112",
            "Comments": "See named worksheet"
        },
        {
            "1891": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "11",
            "DoBIH Number": "30",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=240927&y=721215&z=3&sv=240927,721215&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4092721215",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=30",
            "Name": "Cruach Ardrain",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "1045.9",
            "Height (ft)": "3431",
            "Map 1:50": "51 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN409212",
            "GridRefXY": "NN4092721215",
            "xcoord": "240927",
            "ycoord": "721215",
            "Post 1997": "MUN",
            "Comments": "See named worksheet"
        },
        {
            "1891": "TOP",
            "Running No": "12",
            "DoBIH Number": "40",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=241285&y=721715&z=3&sv=241285,721715&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4128521715",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=40",
            "Name": "Cruach Ardrain - Stob Garbh SE Top",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "923.4",
            "Height (ft)": "3030",
            "Map 1:50": "51 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN412217",
            "GridRefXY": "NN4128521715",
            "xcoord": "241285",
            "ycoord": "721715"
        },
        {
            "1891": "TOP",
            "1921": "TOP",
            "1933": "TOP",
            "1953": "TOP",
            "1969": "TOP",
            "1974": "TOP",
            "1981": "TOP",
            "1984": "TOP",
            "1990": "TOP",
            "1997": "TOP",
            "Running No": "13",
            "DoBIH Number": "34",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=241112&y=722142&z=3&sv=241112,722142&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4111222142",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=34",
            "Name": "Cruach Ardrain - Stob Garbh",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "957.7",
            "Height (ft)": "3142",
            "Map 1:50": "51",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN411221",
            "GridRefXY": "NN4111222142",
            "xcoord": "241112",
            "ycoord": "722142",
            "Post 1997": "TOP"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "14",
            "DoBIH Number": "31",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=237873&y=719343&z=3&sv=237873,719343&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN3787319343",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=31",
            "Name": "An Caisteal",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "995.8",
            "Height (ft)": "3267",
            "Map 1:50": "50 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN378193",
            "GridRefXY": "NN3787319343",
            "xcoord": "237873",
            "ycoord": "719343",
            "Post 1997": "MUN"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "15",
            "DoBIH Number": "35",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=241660&y=719604&z=3&sv=241660,719604&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN4166019604",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=35",
            "Name": "Beinn Tulaichean",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "945.8",
            "Height (ft)": "3103",
            "Map 1:50": "56",
            "Map 1:25": "OL46N 365N",
            "Grid Ref": "NN416196",
            "GridRefXY": "NN4166019604",
            "xcoord": "241660",
            "ycoord": "719604",
            "Post 1997": "MUN"
        },
        {
            "Running No": "16",
            "DoBIH Number": "2925",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=238755&y=718573&z=3&sv=238755,718573&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN3875518573",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=2925",
            "Name": "Beinn a' Chroin",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "941.4",
            "Height (ft)": "3089",
            "Map 1:50": "50 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN387185",
            "GridRefXY": "NN3875518573",
            "xcoord": "238755",
            "ycoord": "718573",
            "Post 1997": "MUN",
            "Comments": "Given as the Munro on the SMC's website and its Munros CD"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "17",
            "DoBIH Number": "36",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=239396&y=718594&z=3&sv=239396,718594&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN3939618594",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=36",
            "Name": "Beinn a' Chroin East Top [Beinn a' Chroin]",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "940.1",
            "Height (ft)": "3084",
            "Map 1:50": "50 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN393185",
            "GridRefXY": "NN3939618594",
            "xcoord": "239396",
            "ycoord": "718594",
            "Post 1997": "TOP",
            "Comments": "Expected to become a Top following the move of the Munro to hill 2925 above.  See http://www.hills-database.co.uk/database_notes.html#beinn_a_chroin"
        },
        {
            "1891": "TOP",
            "1921": "TOP",
            "1933": "TOP",
            "1953": "TOP",
            "1969": "TOP",
            "1974": "TOP",
            "1981": "TOP",
            "1984": "TOP",
            "1990": "TOP",
            "1997": "TOP",
            "Running No": "18",
            "DoBIH Number": "37",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=238588&y=718550&z=3&sv=238588,718550&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN3858818550",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=37",
            "Name": "Beinn a' Chroin West Top",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "938",
            "Height (ft)": "3077",
            "Map 1:50": "50 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN385185",
            "GridRefXY": "NN3858818550",
            "xcoord": "238588",
            "ycoord": "718550",
            "Post 1997": "TOP",
            "Comments": "Expected to be deleted from the Tops; only 200m from the new Munro location (hill 2925) with c.10m of drop"
        },
        {
            "1891": "MUN",
            "1921": "MUN",
            "1933": "MUN",
            "1953": "MUN",
            "1969": "MUN",
            "1974": "MUN",
            "1981": "MUN",
            "1984": "MUN",
            "1990": "MUN",
            "1997": "MUN",
            "Running No": "19",
            "DoBIH Number": "38",
            "Streetmap": "http://www.streetmap.co.uk/newmap.srf?x=236760&y=717957&z=3&sv=236760,717957&st=4&tl=~&bi=~&lu=N&ar=y",
            "Geograph": "http://www.geograph.org.uk/gridref/NN3676017957",
            "Hill-bagging": "http://www.hill-bagging.co.uk/mountaindetails.php?qu=S&rf=38",
            "Name": "Beinn Chabhair",
            "SMC Section": "1",
            "RHB Section": "01C",
            "_Section": "1.3",
            "Height (m)": "932.1",
            "Height (ft)": "3058",
            "Map 1:50": "50 56",
            "Map 1:25": "OL39N 364N",
            "Grid Ref": "NN367179",
            "GridRefXY": "NN3676017957",
            "xcoord": "236760",
            "ycoord": "717957",
            "Post 1997": "MUN"
        }];














        var params = new ngTableParams(requestParams);
        data = params.filter() ? $filter('filter')(data, params.filter()) : data;
        data = params.sorting() ? $filter('orderBy')(data, params.orderBy()) : data;

        var total = data.length;
        data = data.slice((params.page() - 1) * params.count(), params.page() * params.count());

        return [200, {
            result: data,
            total: total
        }];
    });
    $httpBackend.whenGET(/.*/).passThrough();
});